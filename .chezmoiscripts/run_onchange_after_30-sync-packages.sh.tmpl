#!/usr/bin/env bash
set -euo pipefail

# {{ include "private_dot_config/homebrew/Brewfile.tmpl" | sha256sum }}

# Initialize mise if available
if command -v mise >/dev/null 2>&1; then
    eval "$(mise activate bash)"
fi

echo "ğŸ“¦ Syncing package managers..."

# Homebrew packages
echo "ğŸº Homebrew Bundle: Ensuring system matches Brewfile..."
brew bundle install --global --cleanup --force
echo "âœ… Homebrew state synced."

# Mise packages
echo "ğŸ”§ Mise: Installing managed tools..."
if command -v mise >/dev/null 2>&1; then
    mise install
    mise install --global
    echo "âœ… Mise tools installed."
else
    echo "âš ï¸  Mise not found. Skipping mise tools."
fi

echo "âœ… Package sync complete!"
